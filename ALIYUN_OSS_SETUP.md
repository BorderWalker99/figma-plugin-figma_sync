# é˜¿é‡Œäº‘ OSS é…ç½®æŒ‡å—

## å‰ææ¡ä»¶

âœ… å·²å®Œæˆï¼šBucket åˆ›å»º

## é…ç½®æ­¥éª¤

### æ­¥éª¤ 2ï¼šè·å– AccessKey ID å’Œ Secret

#### 2.1 åˆ›å»º RAM ç”¨æˆ·ï¼ˆæ¨èï¼‰

1. **ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°**
   - è®¿é—®ï¼šhttps://ram.console.aliyun.com/
   - ä½¿ç”¨ä¸»è´¦å·ç™»å½•

2. **åˆ›å»º RAM ç”¨æˆ·**
   - å·¦ä¾§å¯¼èˆªï¼š**ç”¨æˆ·** â†’ **åˆ›å»ºç”¨æˆ·**
   - è®¿é—®æ–¹å¼ï¼š
     - âœ… **ä½¿ç”¨æ°¸ä¹… AccessKey è®¿é—®**ï¼ˆå¿…é¡»å‹¾é€‰ï¼‰
     - âŒ æ§åˆ¶å°è®¿é—®ï¼ˆå¯é€‰ï¼Œå¦‚æœä¸éœ€è¦ç”¨æˆ·ç™»å½•æ§åˆ¶å°ï¼‰

3. **æŸ¥çœ‹æˆ–åˆ›å»º AccessKey**

   **æ­¥éª¤ 1ï¼šè¿›å…¥ AccessKey é¡µé¢**
   - åˆ›å»ºç”¨æˆ·åï¼Œç‚¹å‡»ç”¨æˆ·åç§°è¿›å…¥è¯¦æƒ…é¡µ
   - ç‚¹å‡»é¡¶éƒ¨æ ‡ç­¾é¡µä¸­çš„ **AccessKey** æ ‡ç­¾

   **æ­¥éª¤ 2ï¼šæŸ¥çœ‹ç°æœ‰ AccessKeyï¼ˆå¦‚æœå·²æœ‰ï¼‰**
   - åœ¨ AccessKey åˆ—è¡¨ä¸­ï¼Œé€šå¸¸åªæ˜¾ç¤º **AccessKey ID**ï¼ˆä¾‹å¦‚ï¼š`LTAI5txxxxxxxxxxxxx`ï¼‰
   - âš ï¸ **é‡è¦**ï¼š**AccessKey Secret ä¸ä¼šåœ¨åˆ—è¡¨ä¸­æ˜¾ç¤º**ï¼Œè¿™æ˜¯é˜¿é‡Œäº‘çš„å®‰å…¨æœºåˆ¶
   - å¦‚æœä¹‹å‰åˆ›å»º AccessKey æ—¶æ²¡æœ‰ä¿å­˜ Secretï¼Œ**æ— æ³•å†æ¬¡æŸ¥çœ‹**ï¼Œåªèƒ½åˆ›å»ºæ–°çš„ AccessKey
   - å¦‚æœä¹‹å‰å·²ä¿å­˜è¿‡ Secretï¼Œè¯·ä½¿ç”¨ä¿å­˜çš„ Secretï¼›å¦‚æœæ²¡æœ‰ä¿å­˜ï¼Œéœ€è¦åˆ›å»ºæ–°çš„ AccessKey

   **æ­¥éª¤ 3ï¼šåˆ›å»ºæ–°çš„ AccessKeyï¼ˆå¦‚æœæ²¡æœ‰æˆ–æ— æ³•æŸ¥çœ‹ Secretï¼‰**
   - ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ **åˆ›å»º AccessKey** æŒ‰é’®
   - å¦‚æœå·²æœ‰ AccessKeyï¼Œç³»ç»Ÿä¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼š
     - æ ‡é¢˜ï¼š**ç¡®è®¤å½“å‰ AccessKey ç”¨äºè½®è½¬**
     - æç¤ºï¼šå½“å‰ç”¨æˆ·å·²åˆ›å»º AccessKeyï¼Œç¡®è®¤æœ¬æ¬¡åˆ›å»ºçš„ AccessKey ä»…ç”¨äºè½®è½¬
     - é€‰æ‹©ç”¨é€”ï¼šé€‰æ‹© **"æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨"** æˆ– **"å…¶ä»–"**
     - å‹¾é€‰ï¼š**"æˆ‘ç¡®è®¤å¿…é¡»åˆ›å»º AccessKey"**
     - ç‚¹å‡» **ç»§ç»­åˆ›å»º** æŒ‰é’®
   - ç³»ç»Ÿä¼šå¼¹å‡ºå¯¹è¯æ¡†æ˜¾ç¤ºæ–°åˆ›å»ºçš„ AccessKey ID å’Œ Secret
   - **é‡è¦**ï¼šSecret åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·ç«‹å³å¤åˆ¶ä¿å­˜ï¼
   - å»ºè®®ï¼šå¤åˆ¶åˆ°å®‰å…¨çš„åœ°æ–¹ï¼ˆå¦‚å¯†ç ç®¡ç†å™¨æˆ–æœ¬åœ°æ–‡ä»¶ï¼‰
   - åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥åˆ é™¤æ—§çš„ AccessKeyï¼ˆå¦‚æœä¸å†éœ€è¦ï¼‰

4. **è®°å½• AccessKey ä¿¡æ¯**
   ```
   AccessKey ID: LTAI5txxxxxxxxxxxxx
   AccessKey Secret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```
   
   **æç¤º**ï¼š
   - AccessKey Secret ä¸ä¼šåœ¨åˆ—è¡¨ä¸­æ˜¾ç¤ºï¼Œè¿™æ˜¯é˜¿é‡Œäº‘çš„å®‰å…¨æœºåˆ¶
   - å¦‚æœä¹‹å‰åˆ›å»º AccessKey æ—¶æ²¡æœ‰ä¿å­˜ Secretï¼Œæ— æ³•å†æ¬¡æŸ¥çœ‹ï¼Œåªèƒ½åˆ›å»ºæ–°çš„ AccessKey
   - åˆ›å»ºæ–° AccessKey æ—¶ï¼Œé€‰æ‹©ç”¨é€”ä¸º **"æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨"** æˆ– **"å…¶ä»–"**
   - åˆ›å»ºæ–° AccessKey åï¼Œå¯ä»¥åˆ é™¤æ—§çš„ AccessKeyï¼ˆå¦‚æœä¸å†éœ€è¦ï¼‰

#### 2.2 æˆæƒ RAM ç”¨æˆ· OSS æƒé™

1. **åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥**
   - å·¦ä¾§å¯¼èˆªï¼š**æƒé™ç®¡ç†** â†’ **ç­–ç•¥** â†’ **åˆ›å»ºç­–ç•¥**
   - ç­–ç•¥åç§°ï¼š`FigmaSync-OSS-FullAccess`
   - ç­–ç•¥å†…å®¹ï¼š
   ```json
   {
     "Version": "1",
     "Statement": [
       {
         "Effect": "Allow",
         "Action": [
           "oss:PutObject",
           "oss:GetObject",
           "oss:DeleteObject",
           "oss:ListObjects",
           "oss:ListObjectsV2",
           "oss:GetObjectMeta",
           "oss:HeadObject"
         ],
         "Resource": [
           "acs:oss:*:*:ä½ çš„Bucketåç§°/*"
         ]
       },
       {
         "Effect": "Allow",
         "Action": [
           "oss:ListObjects",
           "oss:ListObjectsV2"
         ],
         "Resource": [
           "acs:oss:*:*:ä½ çš„Bucketåç§°"
         ]
       }
     ]
   }
   ```
   - ç‚¹å‡» **ç¡®å®š** åˆ›å»ºç­–ç•¥

2. **æˆæƒç­–ç•¥ç»™ RAM ç”¨æˆ·**
   - è¿›å…¥ RAM ç”¨æˆ·è¯¦æƒ…é¡µ
   - ç‚¹å‡» **æ·»åŠ æƒé™**
   - é€‰æ‹©åˆšåˆ›å»ºçš„ç­–ç•¥ï¼š`FigmaSync-OSS-FullAccess`
   - ç‚¹å‡» **ç¡®å®š**

#### 2.3 ä½¿ç”¨ä¸»è´¦å· AccessKeyï¼ˆä¸æ¨èï¼Œä»…æµ‹è¯•ç”¨ï¼‰

âš ï¸ **ä¸æ¨è**ï¼šä¸»è´¦å· AccessKey æƒé™è¿‡å¤§ï¼Œå­˜åœ¨å®‰å…¨é£é™©

å¦‚æœåªæ˜¯æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨ä¸»è´¦å·çš„ AccessKeyï¼š
1. å³ä¸Šè§’å¤´åƒ â†’ **AccessKey ç®¡ç†**
2. åˆ›å»º AccessKeyï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
3. è®°å½• AccessKey ID å’Œ Secret

---

### æ­¥éª¤ 3ï¼šè·å– BUCKET å’Œ REGION

#### 3.1 æŸ¥çœ‹ Bucket åç§°

1. **ç™»å½• OSS æ§åˆ¶å°**
   - è®¿é—®ï¼šhttps://oss.console.aliyun.com/
   - åœ¨ **Bucket åˆ—è¡¨** ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰ Bucket
   - è®°å½•ä½ çš„ Bucket åç§°ï¼ˆä¾‹å¦‚ï¼š`figmasync-bucket`ï¼‰

#### 3.2 æŸ¥çœ‹ Regionï¼ˆåœ°åŸŸï¼‰

1. **æŸ¥çœ‹ Bucket è¯¦æƒ…**
   - ç‚¹å‡» Bucket åç§°è¿›å…¥è¯¦æƒ…é¡µ
   - åœ¨ **æ¦‚è§ˆ** é¡µé¢å¯ä»¥çœ‹åˆ° **åœ°åŸŸ** ä¿¡æ¯
   - å¸¸è§åœ°åŸŸï¼š
     - `oss-cn-hangzhou`ï¼ˆåä¸œ1-æ­å·ï¼‰
     - `oss-cn-shanghai`ï¼ˆåä¸œ2-ä¸Šæµ·ï¼‰
     - `oss-cn-beijing`ï¼ˆååŒ—2-åŒ—äº¬ï¼‰
     - `oss-cn-shenzhen`ï¼ˆåå—1-æ·±åœ³ï¼‰
     - `oss-cn-hongkong`ï¼ˆé¦™æ¸¯ï¼‰

2. **è®°å½• Region**
   ```
   Region: oss-cn-hangzhou
   ```

---

### æ­¥éª¤ 4ï¼šè®¾ç½® ROOT_FOLDER

#### 4.1 ç†è§£ ROOT_FOLDER

`ROOT_FOLDER` æ˜¯ OSS ä¸­çš„æ ¹æ–‡ä»¶å¤¹åç§°ï¼Œæ‰€æœ‰ç”¨æˆ·çš„æ–‡ä»¶å¤¹éƒ½ä¼šåˆ›å»ºåœ¨è¿™ä¸ªæ ¹æ–‡ä»¶å¤¹ä¸‹ã€‚

**æ–‡ä»¶å¤¹ç»“æ„ç¤ºä¾‹ï¼š**
```
Bucket: figmasync-bucket
  â””â”€â”€ FigmaSync/ï¼ˆROOT_FOLDERï¼‰
      â”œâ”€â”€ FigmaSync-user1@mac1/ï¼ˆç”¨æˆ·1çš„æ–‡ä»¶å¤¹ï¼‰
      â”œâ”€â”€ FigmaSync-user2@mac2/ï¼ˆç”¨æˆ·2çš„æ–‡ä»¶å¤¹ï¼‰
      â””â”€â”€ FigmaSync-user3@mac3/ï¼ˆç”¨æˆ·3çš„æ–‡ä»¶å¤¹ï¼‰
```

#### 4.2 è®¾ç½® ROOT_FOLDER

**é»˜è®¤å€¼**ï¼š`FigmaSync`

**è‡ªå®šä¹‰å€¼**ï¼šå¯ä»¥æ˜¯ä»»ä½•åç§°ï¼Œä¾‹å¦‚ï¼š
- `FigmaSync`
- `MyFigmaFiles`
- `Screenshots`

**å»ºè®®**ï¼šä½¿ç”¨é»˜è®¤å€¼ `FigmaSync`ï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ã€‚

---

## å¿«é€Ÿé…ç½®æ–¹æ³•

### æ–¹æ³• 1ï¼šä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

è¿è¡Œå®‰è£…è„šæœ¬ï¼ŒæŒ‰æç¤ºè¾“å…¥é…ç½®ä¿¡æ¯ï¼š

```bash
cd /Users/sucao/Downloads/FigmaSync
./install-and-run.sh
```

é€‰æ‹©æ¨¡å¼æ—¶é€‰æ‹© `[2]`ï¼ˆé˜¿é‡Œäº‘ OSS ä¸Šä¼ æ¨¡å¼ï¼‰ï¼Œç„¶åæŒ‰æç¤ºè¾“å…¥ï¼š

1. **ALIYUN_ACCESS_KEY_ID**ï¼šè¾“å…¥æ­¥éª¤ 2 è·å–çš„ AccessKey ID
2. **ALIYUN_ACCESS_KEY_SECRET**ï¼šè¾“å…¥æ­¥éª¤ 2 è·å–çš„ AccessKey Secret
3. **ALIYUN_BUCKET**ï¼šè¾“å…¥æ­¥éª¤ 3 è·å–çš„ Bucket åç§°
4. **ALIYUN_REGION**ï¼šè¾“å…¥æ­¥éª¤ 3 è·å–çš„ Regionï¼ˆç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤å€¼ `oss-cn-hangzhou`ï¼‰
5. **ALIYUN_ROOT_FOLDER**ï¼šè¾“å…¥æ ¹æ–‡ä»¶å¤¹åç§°ï¼ˆç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤å€¼ `FigmaSync`ï¼‰

è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»º `.env` æ–‡ä»¶å¹¶ä¿å­˜é…ç½®ã€‚

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨åˆ›å»º .env æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
cd /Users/sucao/Downloads/FigmaSync
touch .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```bash
# é˜¿é‡Œäº‘ OSS é…ç½®
ALIYUN_ACCESS_KEY_ID=LTAI5txxxxxxxxxxxxx
ALIYUN_ACCESS_KEY_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ALIYUN_BUCKET=figmasync-bucket
ALIYUN_REGION=oss-cn-hangzhou
ALIYUN_ROOT_FOLDER=FigmaSync
```

**æ›¿æ¢è¯´æ˜ï¼š**
- `LTAI5txxxxxxxxxxxxx` â†’ ä½ çš„ AccessKey ID
- `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx` â†’ ä½ çš„ AccessKey Secret
- `figmasync-bucket` â†’ ä½ çš„ Bucket åç§°
- `oss-cn-hangzhou` â†’ ä½ çš„ Regionï¼ˆå¦‚æœä¸æ˜¯æ­å·ï¼Œè¯·ä¿®æ”¹ï¼‰
- `FigmaSync` â†’ ä½ çš„æ ¹æ–‡ä»¶å¤¹åç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤å€¼ï¼‰

---

## éªŒè¯é…ç½®

### éªŒè¯æ–¹æ³• 1ï¼šä½¿ç”¨æµ‹è¯•è„šæœ¬

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test-oss-config.js`ï¼š

```javascript
require('dotenv').config();
const { getOSSClient, listFolderFiles, createFolder } = require('./aliyunOSS');

async function testOSSConfig() {
  console.log('ğŸ” å¼€å§‹éªŒè¯ OSS é…ç½®...\n');
  
  try {
    // 1. æ£€æŸ¥ç¯å¢ƒå˜é‡
    console.log('1ï¸âƒ£ æ£€æŸ¥ç¯å¢ƒå˜é‡...');
    const requiredVars = [
      'ALIYUN_ACCESS_KEY_ID',
      'ALIYUN_ACCESS_KEY_SECRET',
      'ALIYUN_BUCKET',
      'ALIYUN_REGION'
    ];
    
    const missingVars = requiredVars.filter(v => !process.env[v]);
    if (missingVars.length > 0) {
      console.error('âŒ ç¼ºå°‘ç¯å¢ƒå˜é‡:', missingVars.join(', '));
      console.error('   è¯·æ£€æŸ¥ .env æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡é…ç½®');
      return;
    }
    
    console.log('   âœ… ALIYUN_ACCESS_KEY_ID:', process.env.ALIYUN_ACCESS_KEY_ID.substring(0, 10) + '...');
    console.log('   âœ… ALIYUN_ACCESS_KEY_SECRET:', '***' + process.env.ALIYUN_ACCESS_KEY_SECRET.substring(process.env.ALIYUN_ACCESS_KEY_SECRET.length - 4));
    console.log('   âœ… ALIYUN_BUCKET:', process.env.ALIYUN_BUCKET);
    console.log('   âœ… ALIYUN_REGION:', process.env.ALIYUN_REGION);
    console.log('   âœ… ALIYUN_ROOT_FOLDER:', process.env.ALIYUN_ROOT_FOLDER || 'FigmaSync (é»˜è®¤)');
    
    // 2. æµ‹è¯• OSS è¿æ¥
    console.log('\n2ï¸âƒ£ æµ‹è¯• OSS è¿æ¥...');
    const client = getOSSClient();
    console.log('   âœ… OSS å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸ');
    
    // 3. æµ‹è¯•åˆ—å‡ºæ–‡ä»¶ï¼ˆæµ‹è¯•æƒé™ï¼‰
    console.log('\n3ï¸âƒ£ æµ‹è¯•åˆ—å‡ºæ–‡ä»¶ï¼ˆæµ‹è¯•æƒé™ï¼‰...');
    const rootFolder = process.env.ALIYUN_ROOT_FOLDER || 'FigmaSync';
    try {
      const result = await listFolderFiles({ folderId: rootFolder, pageSize: 5 });
      console.log(`   âœ… æˆåŠŸè®¿é—®æ ¹æ–‡ä»¶å¤¹: ${rootFolder}`);
      console.log(`   ğŸ“ æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ•°é‡: ${result.files.length}`);
      if (result.files.length > 0) {
        console.log('   ğŸ“„ ç¤ºä¾‹æ–‡ä»¶:');
        result.files.slice(0, 3).forEach(file => {
          console.log(`      - ${file.name}`);
        });
      }
    } catch (error) {
      if (error.message.includes('NoSuchKey') || error.message.includes('404')) {
        console.log(`   âš ï¸  æ ¹æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œå°†å°è¯•åˆ›å»º...`);
        try {
          await createFolder({ folderName: rootFolder, parentFolderId: '' });
          console.log(`   âœ… æ ¹æ–‡ä»¶å¤¹åˆ›å»ºæˆåŠŸ: ${rootFolder}`);
        } catch (createError) {
          console.error('   âŒ åˆ›å»ºæ ¹æ–‡ä»¶å¤¹å¤±è´¥:', createError.message);
          throw createError;
        }
      } else {
        throw error;
      }
    }
    
    // 4. æµ‹è¯•åˆ›å»ºç”¨æˆ·æ–‡ä»¶å¤¹
    console.log('\n4ï¸âƒ£ æµ‹è¯•åˆ›å»ºç”¨æˆ·æ–‡ä»¶å¤¹...');
    const testUserId = 'test-user@test-mac';
    const testFolderName = `FigmaSync-${testUserId}`;
    try {
      const folder = await createFolder({
        folderName: testFolderName,
        parentFolderId: rootFolder
      });
      console.log(`   âœ… ç”¨æˆ·æ–‡ä»¶å¤¹åˆ›å»ºæˆåŠŸ: ${folder.id}`);
      console.log(`   ğŸ“‚ æ–‡ä»¶å¤¹è·¯å¾„: ${folder.id}`);
    } catch (error) {
      console.error('   âŒ åˆ›å»ºç”¨æˆ·æ–‡ä»¶å¤¹å¤±è´¥:', error.message);
      throw error;
    }
    
    console.log('\nâœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼OSS é…ç½®æ­£ç¡®ã€‚\n');
    console.log('ğŸ“ é…ç½®æ‘˜è¦:');
    console.log(`   - Bucket: ${process.env.ALIYUN_BUCKET}`);
    console.log(`   - Region: ${process.env.ALIYUN_REGION}`);
    console.log(`   - Root Folder: ${rootFolder}`);
    console.log(`   - ç”¨æˆ·æ–‡ä»¶å¤¹æ ¼å¼: ${rootFolder}/FigmaSync-{userId}/`);
    
  } catch (error) {
    console.error('\nâŒ é…ç½®éªŒè¯å¤±è´¥ï¼');
    console.error('   é”™è¯¯ä¿¡æ¯:', error.message);
    if (error.code) {
      console.error('   é”™è¯¯ä»£ç :', error.code);
    }
    console.error('\nğŸ’¡ å¸¸è§é—®é¢˜:');
    console.error('   1. æ£€æŸ¥ AccessKey ID å’Œ Secret æ˜¯å¦æ­£ç¡®');
    console.error('   2. æ£€æŸ¥ RAM ç”¨æˆ·æ˜¯å¦æœ‰ OSS æƒé™');
    console.error('   3. æ£€æŸ¥ Bucket åç§°æ˜¯å¦æ­£ç¡®');
    console.error('   4. æ£€æŸ¥ Region æ˜¯å¦æ­£ç¡®');
    console.error('   5. æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸');
    process.exit(1);
  }
}

testOSSConfig();
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
cd /Users/sucao/Downloads/FigmaSync
node test-oss-config.js
```

### éªŒè¯æ–¹æ³• 2ï¼šå¯åŠ¨æœåŠ¡æµ‹è¯•

1. **å¯åŠ¨æœåŠ¡**
   ```bash
   cd /Users/sucao/Downloads/FigmaSync
   npm start
   ```

2. **æ£€æŸ¥å¯åŠ¨æ—¥å¿—**
   å¦‚æœé…ç½®æ­£ç¡®ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
   ```
   âœ… é˜¿é‡Œäº‘ OSS æ¨¡å—å·²åŠ è½½ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
   âœ… é˜¿é‡Œäº‘ OSS ä¸Šä¼ æ¥å£å·²å¯ç”¨: POST /upload-oss
   ```

3. **æµ‹è¯•ä¸Šä¼ **
   - ä½¿ç”¨ iPhone å¿«æ·æŒ‡ä»¤ä¸Šä¼ ä¸€å¼ æˆªå›¾
   - æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
     ```
     ğŸ“¤ [OSSä¸Šä¼ ] å¼€å§‹ä¸Šä¼ åˆ° OSS: æˆªå›¾.jpg â†’ æ–‡ä»¶å¤¹ FigmaSync/FigmaSync-user1@mac1/
     âœ… [OSSä¸Šä¼ ] æˆªå›¾.jpg (æ–‡ä»¶ID: FigmaSync/FigmaSync-user1@mac1/æˆªå›¾.jpg)
     ```

### éªŒè¯æ–¹æ³• 3ï¼šæ£€æŸ¥ .env æ–‡ä»¶

```bash
cd /Users/sucao/Downloads/FigmaSync
cat .env
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼å†…å®¹ï¼š
```bash
ALIYUN_ACCESS_KEY_ID=LTAI5txxxxxxxxxxxxx
ALIYUN_ACCESS_KEY_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ALIYUN_BUCKET=figmasync-bucket
ALIYUN_REGION=oss-cn-hangzhou
ALIYUN_ROOT_FOLDER=FigmaSync
```

---

## å¸¸è§é—®é¢˜

### 1. AccessKey æƒé™ä¸è¶³

**é”™è¯¯ä¿¡æ¯ï¼š**
```
AccessDenied: You are not authorized to perform this operation
```

**è§£å†³æ–¹æ³•ï¼š**
- æ£€æŸ¥ RAM ç”¨æˆ·æ˜¯å¦å·²æˆæƒ OSS æƒé™ç­–ç•¥
- æ£€æŸ¥ç­–ç•¥ä¸­çš„ Bucket åç§°æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç­–ç•¥ä¸­çš„æƒé™æ˜¯å¦åŒ…å«æ‰€éœ€çš„æ“ä½œ

### 2. Bucket ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯ï¼š**
```
NoSuchBucket: The specified bucket does not exist
```

**è§£å†³æ–¹æ³•ï¼š**
- æ£€æŸ¥ Bucket åç§°æ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
- æ£€æŸ¥ Bucket æ˜¯å¦åœ¨æ­£ç¡®çš„ Region

### 3. Region ä¸åŒ¹é…

**é”™è¯¯ä¿¡æ¯ï¼š**
```
The bucket you are attempting to access must be addressed using the specified endpoint
```

**è§£å†³æ–¹æ³•ï¼š**
- æ£€æŸ¥ Region æ˜¯å¦æ­£ç¡®
- ç¡®ä¿ Bucket å’Œ Region åŒ¹é…

### 4. ç¯å¢ƒå˜é‡æœªåŠ è½½

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ç¼ºå°‘é˜¿é‡Œäº‘ OSS é…ç½®: è¯·è®¾ç½® ALIYUN_ACCESS_KEY_ID å’Œ ALIYUN_ACCESS_KEY_SECRET ç¯å¢ƒå˜é‡
```

**è§£å†³æ–¹æ³•ï¼š**
- ç¡®ä¿ `.env` æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•
- ç¡®ä¿å®‰è£…äº† `dotenv` åŒ…ï¼š`npm install dotenv`
- æ£€æŸ¥ `.env` æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆæ¯è¡Œä¸€ä¸ªå˜é‡ï¼Œæ— ç©ºæ ¼ï¼‰

---

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œå¯ä»¥ï¼š

1. **å¯åŠ¨æœåŠ¡**
   ```bash
   npm start
   ```

2. **é…ç½® iPhone å¿«æ·æŒ‡ä»¤**
   - ä½¿ç”¨ `/upload-oss` æ¥å£
   - æ·»åŠ  `x-user-id` è¯·æ±‚å¤´

3. **åœ¨ Figma æ’ä»¶ä¸­é€‰æ‹©é˜¿é‡Œäº‘ OSS æ¨¡å¼**
   - æ‰“å¼€ Figma æ’ä»¶
   - è¿›å…¥è®¾ç½®
   - é€‰æ‹©ã€Œé˜¿é‡Œäº‘ OSS ä¸Šä¼ ã€æ¨¡å¼

---

## é…ç½®æ£€æŸ¥æ¸…å•

- [ ] å·²åˆ›å»º RAM ç”¨æˆ·
- [ ] å·²åˆ›å»º AccessKey å¹¶ä¿å­˜ ID å’Œ Secret
- [ ] å·²æˆæƒ RAM ç”¨æˆ· OSS æƒé™
- [ ] å·²è®°å½• Bucket åç§°
- [ ] å·²è®°å½• Region
- [ ] å·²è®¾ç½® ROOT_FOLDERï¼ˆæˆ–ä½¿ç”¨é»˜è®¤å€¼ï¼‰
- [ ] å·²åˆ›å»º `.env` æ–‡ä»¶å¹¶å¡«å†™é…ç½®
- [ ] å·²è¿è¡ŒéªŒè¯æµ‹è¯•å¹¶é€šè¿‡
- [ ] å·²å¯åŠ¨æœåŠ¡å¹¶æµ‹è¯•ä¸Šä¼ åŠŸèƒ½

---

## å®‰å…¨å»ºè®®

1. **ä½¿ç”¨ RAM å­è´¦å·**ï¼šä¸è¦ä½¿ç”¨ä¸»è´¦å· AccessKey
2. **æœ€å°æƒé™åŸåˆ™**ï¼šåªæˆäºˆå¿…è¦çš„ OSS æƒé™
3. **å®šæœŸè½®æ¢ AccessKey**ï¼šå»ºè®®æ¯ 90 å¤©æ›´æ¢ä¸€æ¬¡
4. **ä¿æŠ¤ AccessKey Secret**ï¼šä¸è¦å°† Secret æäº¤åˆ°ä»£ç ä»“åº“
5. **ä½¿ç”¨ .env æ–‡ä»¶**ï¼šå°†æ•æ„Ÿä¿¡æ¯ä¿å­˜åœ¨ `.env` æ–‡ä»¶ä¸­ï¼Œå¹¶æ·»åŠ åˆ° `.gitignore`

